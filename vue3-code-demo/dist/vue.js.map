{"version":3,"file":"vue.js","sources":["../src/reactivity/computed.ts","../src/reactivity/effect.ts","../src/shared/index.ts","../src/reactivity/baseHandlers.ts","../src/reactivity/reactive.ts","../src/reactivity/ref.ts"],"sourcesContent":["/*\n * @Author: 鲍佳玮\n * @Date: 2022-01-28 20:28:54\n * @LastEditors: 鲍佳玮\n * @LastEditTime: 2022-01-28 20:31:33\n * @Description: computed\n */\nexport function computed() {}\n","/*\n * @Author: 鲍佳玮\n * @Date: 2022-01-28 20:29:26\n * @LastEditors: 鲍佳玮\n * @LastEditTime: 2022-01-28 20:31:42\n * @Description: effect\n */\nexport function effect() {}\n","/*\n * @Author: 鲍佳玮\n * @Date: 2022-01-28 21:05:13\n * @LastEditors: 鲍佳玮\n * @LastEditTime: 2022-01-28 21:47:30\n * @Description: 工具\n */\nexport const isObject = val => typeof val === 'object' && val != null\nexport const isSymbol = val => typeof val === 'symbol'\nexport const isArray = val => Array.isArray\nexport const isInteger = key => '' + parseInt(key, 10) === key\nconst hasOwnProperty = Object.prototype.hasOwnProperty\nexport const hasOwn = (val, key) => hasOwnProperty.call(val, key)\nexport const hasChanged = (value, oldValue) => value !== oldValue\n","import { hasChanged, hasOwn, isArray, isInteger, isObject, isSymbol } from '../shared/index'\nimport { reactive } from './reactive'\n\nfunction createGetter() {\n  return function get(target, key, receiver) {\n    const res = Reflect.get(target, key, receiver)\n    console.log(res)\n    if (isSymbol(key)) {\n      return res\n    }\n    // 依赖收集\n    if (isObject(res)) {\n      // 取值是对象就代理，懒递归\n      return reactive(res)\n    }\n    return res\n  }\n}\nfunction createSetter() {\n  return function set(target, key, value, receiver) {\n    const oldValue = target[key]\n    const hadKey = isArray(target) && isInteger(target) ? Number(key) < target.length : hasOwn(target, key)\n\n    const result = Reflect.set(target, key, value, receiver)\n    if (!hadKey) {\n      console.log('新增属性')\n    } else if (hasChanged(value, oldValue)) {\n      console.log('修改属性')\n    }\n    return result\n  }\n}\nconst get = createGetter()\nconst set = createSetter()\nexport const mutableHandlers = {\n  get,\n  set\n}\n","import { isObject } from '../shared/index'\nimport { mutableHandlers } from './baseHandlers'\n\n/*\n * @Author: 鲍佳玮\n * @Date: 2022-01-28 20:29:13\n * @LastEditors: 鲍佳玮\n * @LastEditTime: 2022-01-28 21:11:36\n * @Description: reactive\n */\n\nexport function reactive(target) {\n  return createReactiveObject(target, mutableHandlers)\n}\nconst proxyMap = new WeakMap()\nfunction createReactiveObject(target, baseHandlers) {\n  //不是对象不做代理\n  if (!isObject(target)) {\n    return target\n  }\n  const exisitingProxy = proxyMap.get(target)\n  if (exisitingProxy) {\n    return exisitingProxy\n  }\n  const proxy = new Proxy(target, baseHandlers)\n  // 做缓存，将代理过的对象和代理后的结果做一个映射表\n  proxyMap.set(target, proxy)\n  return proxy\n}\n","/*\n * @Author: 鲍佳玮\n * @Date: 2022-01-28 20:30:55\n * @LastEditors: 鲍佳玮\n * @LastEditTime: 2022-01-28 20:32:06\n * @Description: ref\n */\nexport function ref() {}\n"],"names":[],"mappings":"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"}